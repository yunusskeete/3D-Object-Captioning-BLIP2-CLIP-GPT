# 3D Object Captioning with Pretrained Models

## Overview
Cap3D provides detailed descriptions of 3D objects by leveraging pretrained models in captioning, alignment, and LLM to consolidate multi-view information.

The captioning pipelines is composed of two parts:
1. [Caption generation](generate_captions.py) using [BLIP2](https://github.com/salesforce/LAVIS/tree/main/projects/blip2)
2. [Caption refinement](clean_captions.py) using [CLIP](https://github.com/openai/CLIP) and [GPT](https://github.com/openai/openai-python)

<img src="teaser.png" alt="drawing">

## Usage
To run the full captioning pipeline, provide a config in a `config.yaml` file (see [example_config.yaml](example_config.yaml) for reference).
```
python captioning_pipeline.py 
```
NOTE: Captions generated by the [caption generation pipeline](generate_captions.py) often include reference to a "3D model".
To omit such references, edit the `prompt` within the `clean_captions` configuration (`config.yaml`).
For example, include the following `"... Avoid making reference to a 3D model - for example: 'A 3D model of a brown leather sofa' should yield 'A brown leather sofa'..."`

Usage guides on the [caption generation](generate_captions.py) and [caption refinement](clean_captions.py) stages, view their respective module docstrings.

## Acknowledgments
This work is heavily based on [Scalable 3D Captioning with Pretrained Models](https://arxiv.org/abs//2306.07279):
* <a href="https://cap3d-um.github.io/"><img src="https://img.shields.io/static/v1?label=Project&message=Website&color=red" height=20.5></a>
* ```
  @article{luo2023scalable,
        title={Scalable 3D Captioning with Pretrained Models},
        author={Luo, Tiange and Rockwell, Chris and Lee, Honglak and Johnson, Justin},
        journal={arXiv preprint arXiv:2306.07279},
        year={2023}
  }
  ```
* [Tiange Luo*](https://tiangeluo.github.io/), [Chris Rockwell*](https://crockwell.github.io), [Honglak Lee†](https://web.eecs.umich.edu/~honglak/), [Justin Johnson†](https://web.eecs.umich.edu/~justincj) (*Equal contribution    †Equal Advising)